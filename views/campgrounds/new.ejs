<% layout('layout') %>

    <h1>Add a New Campground</h1>

    <form id="campgroundForm" class="needs-validation" action="/campgrounds" method="POST" enctype="multipart/form-data"
        novalidate>
        <div class="form-group">
            <label for="title">Title</label>
            <input type="text" class="form-control" id="title" name="campground[title]" required>
            <div class="invalid-feedback">
                Please enter a title.
            </div>
        </div>

        <div class="form-group">
            <label for="images">Upload Images</label>
            <input type="file" id="image" name="image" multiple>
            <!-- 缩略图展示的容器 -->
            <div id="imagePreviewContainer" style="display: flex; gap: 10px;"></div>
        </div>
        </div>

        <div class="form-group">
            <label for="price">Price</label>
            <input type="number" class="form-control" id="price" name="campground[price]" min="0" required>
            <div class="invalid-feedback">
                Please enter a price greater than or equal to 0.
            </div>
        </div>

        <div class="form-group">
            <label for="description">Description</label>
            <textarea class="form-control" id="description" name="campground[description]" rows="3" required></textarea>
            <div class="invalid-feedback">
                Please enter a description.
            </div>
        </div>

        <div class="form-group">
            <label for="location">Location</label>
            <input type="text" class="form-control" id="location" name="campground[location]" required>
            <div class="invalid-feedback">
                Please enter a location.
            </div>
        </div>

        <div class="button-group">
            <button type="submit" class="btn btn-primary">Create Campground</button>
            <a href="/campgrounds" class="btn btn-secondary">Back to Campgrounds</a>
        </div>
    </form>



    <script>
        const imageInput = document.getElementById('image');
        const imagePreviewContainer = document.getElementById('imagePreviewContainer');

        imageInput.addEventListener('change', function (event) {
            const files = event.target.files;
            imagePreviewContainer.innerHTML = ''; // 清空之前的图片预览

            // 遍历用户选择的所有文件
            Array.from(files).forEach(file => {
                const reader = new FileReader();

                reader.onload = function (e) {
                    const imgElement = document.createElement('img');
                    imgElement.src = e.target.result;
                    imgElement.style.maxWidth = '150px'; // 设置缩略图的最大宽度
                    imgElement.style.maxHeight = '150px'; // 设置缩略图的最大高度
                    imagePreviewContainer.appendChild(imgElement); // 将图片添加到预览容器中
                };

                reader.readAsDataURL(file); // 将图片文件读为 Data URL
            });
        });
    </script>